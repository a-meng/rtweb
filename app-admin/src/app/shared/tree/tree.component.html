<ng-container *ngTemplateOutlet="treeTpl; context: {d:treeData}"></ng-container>
<ng-template #treeTpl let-d='d'>
    <ul>
        <li *ngFor='let item of d' [class.isLeaf]='item.children.length===0'>
            <div class='tree-switcher' [class.close]='closeNodeIds.includes(item.id)' (click)='onSwitch(item.id)'></div>
            <div class='tree-node'>
                <ng-container *ngTemplateOutlet='tpl;context:{node:item}'></ng-container>
            </div>
            <ng-container *ngIf='item.children.length>0 && !closeNodeIds.includes(item.id)'>
                <ng-container *ngTemplateOutlet="treeTpl; context: {d:item.children}"></ng-container>
            </ng-container>
        </li>
    </ul>
</ng-template>
